{% extends "base.html" %}
{% load static %}
{% block title %}Catálogo — Hotel Pacific Reef{% endblock %}
{% block content %}
<div class="container" style="padding:28px 0">
  <h2 style="margin-bottom:16px">Lista de habitaciones</h2>

  {% if error %}
    <p style="color:#b00020">{{ error }}</p>
  {% endif %}

  {% if rooms %}
    <div style="display:grid;gap:14px">
      {% for r in rooms %}
        <div class="card" style="background:#fff;padding:16px;border-radius:12px;display:flex;gap:16px;align-items:center">
          {# 1) Intentamos con imagen desde BD (si la tienes) #}
          {% with img=r.roomimage_set.first %}
            {% if img and img.image_url %}
              <img src="{{ img.image_url }}" alt="" style="width:140px;height:90px;object-fit:cover;border-radius:10px">
            {% else %}
              {# 2) Fallback a imagen local por categoría #}
              {% if r.category|lower == "presidencial" %}
                <img src="{% static 'images/vip.jpg' %}" alt="" style="width:140px;height:90px;object-fit:cover;border-radius:10px">
              {% elif r.category|lower == "ejecutiva" %}
                <img src="{% static 'images/eje.jpg' %}" alt="" style="width:140px;height:90px;object-fit:cover;border-radius:10px">
              {% elif r.category|lower == "turista" %}
                <img src="{% static 'images/eco.png' %}" alt="" style="width:140px;height:90px;object-fit:cover;border-radius:10px">
              {% else %}
                <div style="width:140px;height:90px;background:#eee;border-radius:10px"></div>
              {% endif %}
            {% endif %}
          {% endwith %}

          <div style="flex:1">
            <div style="font-weight:700">{{ r.name }}</div>
            <div style="color:#6d6d6d;font-size:14px">{{ r.description|default:"" }}</div>
            <div style="margin-top:6px">Precio: ${{ r.price_per_night }} CLP / noche</div>
          </div>

          <a class="btn btn--primary"
             href="{% url 'checkout' r.id %}?check_in={{ check_in }}&check_out={{ check_out }}&guests={{ guests }}">
            Seleccionar
          </a>

        </div>
      {% endfor %}
    </div>
  {% else %}
    {% if not error %}
      <p>No hay habitaciones disponibles para ese rango y cantidad de huéspedes.</p>
    {% endif %}
  {% endif %}
</div>
{% endblock %}
